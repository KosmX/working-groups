# Malware scanner

### Some java library that can be embedded in hosting providers and user tools like launchers and modpack creator tools.  

## Matching rules
Standard way for representing JVM malware signatures.  
Rules should be similar to Yara rules (just for JVM application) This means
- [ ] Binary sequence matches (mostly for asset matching)
- [ ] Filtered Java ASM instruction sequences (for example only check for method invocations, but all of them)  
Ability to match only in selected functions could be useful
- [ ] filename matches (with regex)
- [ ] function name/id matches  
- [ ] Match conditions like "at least 10" or "$a or $b and $c"

### Signature database hosting, fetching  
Signature database should be hosted somewhere for allowing the algorithm to quickly "learn" new malwares.  
Executing anything from database is dangerous, see [Runtime Downloading](/docs/runtime-downloading/README.md).  
Any downloaded *data* should be signed to prevent any misuse.


## Detection algorithm  
Should be fast **and** reliable. Reference implementation should be in JVM language.
- [ ] fast matching, like [KMP](https://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm) O(m+n)
- [ ] obfuscation resilent: ignore class hashes when loading file, open any .class what may be executed  
- [ ] low-footpring, threading for speed
- [ ] standalone/CLI interface
- [ ] standalone/GUI interface + installer
- [ ] library interface, use from launchers, third-party apps.

The reference algorithm should be reproducable from matching rules, allow open-source developers to re-write it in othe programming languages.  
